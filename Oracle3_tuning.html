<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Oracle3_tuning</title><meta name="author" content="Jeong Hojin"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: black; font-family:"Calibri Light", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 .s2 { color: #808080; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h1 { color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: bold; text-decoration: none; font-size: 20pt; }
 .s3 { color: #00F; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 11pt; }
 .p, p { color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; margin:0pt; }
 .s4 { color: #1E4E79; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 16pt; }
 .s5 { color: #2D75B5; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s6 { color: #2D75B5; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s7 { color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s8 { color: #1E4E79; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 16pt; }
 .s9 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s10 { color: #F00; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s11 { color: #5B9BD4; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s12 { color: #5B9BD4; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s13 { color: #F00; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s14 { color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s15 { color: #F00; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 .s16 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li:before {content: "- "; color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 li {display: block; }
 #l2 {padding-left: 0pt;counter-reset: d1 0; }
 #l2> li:before {counter-increment: d1; content: counter(d1, decimal)". "; color: black; font-family:"맑은 고딕", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p class="s1" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Oracle 3 - tuning</p><p class="s2" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Wednesday, 18 April 2018</p><p class="s2" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3:27 PM</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Table of Contents</h1><ul id="l1"><li style="padding-top: 9pt;padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Introduction</p><p class="s3" style="padding-left: 24pt;text-indent: 0pt;line-height: 19pt;text-align: left;"><span class="p">- </span>SQL 튜닝 목차</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 19pt;text-align: left;">- <span class="s3">8 types of index access</span></p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index range scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Unique index scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index skip scan</p><p class="s3" style="padding-left: 39pt;text-indent: 0pt;line-height: 19pt;text-align: left;"><span class="p">- </span>Index skip scan 효과를 보기위한 조건</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index full scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index fast full scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index merge scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index bitmap merge scan</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Index join</p></li><li style="padding-left: 17pt;text-indent: -8pt;line-height: 19pt;text-align: left;"><p class="s3" style="display: inline;">Sum up</p></li></ul><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark0">Introduction</a></p><p style="padding-left: 59pt;text-indent: -27pt;line-height: 19pt;text-align: left;">&quot;쿼리의 검색속도를 높이기 위해서 반드시 알아야 하는 기술&quot; 데이터 분석사 --&gt; SQL</p><p style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;line-height: 38pt;text-align: left;">SQL 튜너 &lt;--- 직업 SQL</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 14pt;text-align: left;">|</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">3배차이</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">|</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SQL 튜너 (월 1200만원부터 시작 ~ 2400만원 3.3%)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark1">SQL </a><span class="s6">튜닝 목차</span></p><p class="s7" style="padding-left: 63pt;text-indent: 0pt;line-height: 19pt;text-align: left;">i.     <span class="p">인덱스 튜닝</span></p><p class="s7" style="padding-left: 60pt;text-indent: 0pt;line-height: 19pt;text-align: left;">ii.     <span class="p">조인 문장 튜닝</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 58pt;text-indent: 0pt;line-height: 17pt;text-align: left;">iii.     <span class="p">서브쿼리 문장 튜닝</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 16pt;text-align: left;"><a name="bookmark2">8 types of index access</a></p><ol id="l2"><li style="padding-left: 59pt;text-indent: -18pt;line-height: 18pt;text-align: left;"><p style="display: inline;">Index range scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index unique scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index skip scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index full scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index fast full scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index merge scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index bitmap merge scan</p></li><li style="padding-left: 59pt;text-indent: -18pt;line-height: 19pt;text-align: left;"><p style="display: inline;">Index join</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark3">Index range scan</a></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">인덱스를 부분검색하는 스캔 방법</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Select ename, sal From emp</p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Where job=&#39;SAELSMAN&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 1. 직업에 인덱스를 생성하고 직업의 인덱스의 구조가 어떻게 생겼는지 조회하시오!</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">CREATE INDEX emp_job ON EMP(job);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT job,ROWID FROM EMP WHERE job &gt; &#39; &#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="628" height="262" alt="image" src="Oracle3_tuning/Image_001.jpg"/></span></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 2. 사원이름에 인덱스를 걸고 아래의 SQL이 어느컬럼에 인덱스를 사용하는지</p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">확인하세요.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 17pt;text-align: left;">SET autot traceonly EXPLAIN;</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">// 실행계획만 보겠다</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="304" height="76" alt="image" src="Oracle3_tuning/Image_002.png"/></span></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">SELECT ename,sal,job</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">FROM EMP</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">WHERE job=&#39;ANALYST&#39; AND ename=&#39;ALLEN&#39;;</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">// 인덱스 빠른 쪽으로 엑세스함 (나는 아무것도 안탐)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 3. 문제 2번에서 만약 emp_ename 인덱스를 엑세스 하지 않고 emp_job 인덱스를 했을때</p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 18pt;text-align: left;">인덱스 검색 범위가 더 작은 emp_ename 인덱스를 타게 하려면 어떻게 해야하나?</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 4. 81년도에 입사했고 월급이 3000인 사원의 이름, 입사일, 월급을 출력하는데 월급과 입사일에 인덱스를 걸어서 쿼리를 작성하시오</p><p style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT hiredate,sal FROM EMP</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 17pt;text-align: left;">WHERE hiredate BETWEEN TO_DATE(&#39;1981/01/01&#39;,&#39;RRRR/MM/DD&#39;) AND</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">TO_DATE(&#39;1981/12/31&#39;,&#39;RRRR/MM/DD&#39;) AND sal=3000;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 5. 4번문제에서 월급의 인덱스를 엑세스 하지 못하고 입사일의 인덱스를 엑세스 했다면 월급의 인덱스를 엑세스를 할 수 있도록 힌트를 주시오.</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT /*+ index(emp emp_sal)*/ hiredate, sal FROM EMP</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">WHERE hiredate BETWEEN TO_DATE(&#39;1981/01/01&#39;,&#39;RRRR/MM/DD&#39;) AND</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">TO_DATE(&#39;1981/12/31&#39;,&#39;RRRR/MM/DD&#39;) AND sal=3000;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 6. 부서 번호와 커미션에 각각 인덱스를 생성하고 부서번호가 30번이고 커미션이 300인 사원의 이름, 월급, 커미션, 부서번호를 출력 하시오</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT ename,sal,comm FROM EMP</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">WHERE deptno=30 AND COMM=300;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 17pt;text-align: left;">Set autot on</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="padding-left: 59pt;text-indent: 0pt;line-height: 17pt;text-align: left;">// 이렇게 하면 항상 같이 나옴</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark4">Unique index scan</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">ALTER TABLE EMP</p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 198%;text-align: left;">ADD CONSTRAINT emp_empno_pk PRIMARY KEY(empno); Pb 7. 사원 테이블에 걸린 인덱스 리스트를 조회 하시오</p><p style="padding-top: 5pt;padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT uniqueness,index_name FROM user_indexes</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">WHERE table_name=&#39;EMP&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="213" height="144" alt="image" src="Oracle3_tuning/Image_003.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 8. 사원번호에 empno에 인덱스의 구조를 확인 하시오.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="215" height="366" alt="image" src="Oracle3_tuning/Image_004.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 9. 사원번호가 7654인 사원의 사원 번호와 이름을 조회하는데 인덱스를 통해서 조회될 수 있도록 힌트를 주시오.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT /*+ index_desc(emp emp_empno) */ empno,rowid FROM EMP</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 18pt;text-align: left;">WHERE empno=7654;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="219" height="271" alt="image" src="Oracle3_tuning/Image_005.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 10. 9번 문제의 SQL이 실행될 때의 인덱스 엑세스와 테이블 엑세스를 그림으로</p><p style="text-indent: 0pt;text-align: left;"><span><img width="540" height="210" alt="image" src="Oracle3_tuning/Image_006.jpg"/></span></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">그리시오.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">하나만 access 해서 빠르다</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 11. 사원 번호가 7654 이고 이름이 MARTIN인 사원의 사원 번호, 이름, 월급을 조회하고 사원 번호의 인덱스를 엑세스 했는지</p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">사원 이름의 인덱스를 엑세스 했는지 확인 하시오.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT empno,ename,sal FROM EMP</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">WHERE empno=7654 AND ename=&#39;MARTIN&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="501" height="76" alt="image" src="Oracle3_tuning/Image_007.png"/></span></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">// unique 인덱스를 먼저탄다</p><p style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Primary key 제약이 걸렸다는것은 이미 데이터가 유니크 하다는게 보장이 된 상태라는 것이다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="431" height="93" alt="image" src="Oracle3_tuning/Image_008.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 12. 문제 11번의 인덱스를 ename에 걸린 인덱스를 엑세스 하도록 힌트를 주고 실행하시오</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">SELECT /*+ index_desc(emp emp_ename)*/ empno,ename,sal FROM EMP</p><p style="padding-left: 15pt;text-indent: 26pt;line-height: 18pt;text-align: left;">WHERE empno=7654 AND ename=&#39;MARTIN&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="457" height="77" alt="image" src="Oracle3_tuning/Image_009.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 13. 위에꺼 그림</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 17pt;text-align: left;">// unique scan 과 다르게 하나더 스캔한다</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="454" height="215" alt="image" src="Oracle3_tuning/Image_010.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 14. <span class="p">직업이 SALESMAN 인 사원들의 이름과 월급과 직업을 출력하는 쿼리의</span></p><p style="padding-left: 59pt;text-indent: -27pt;line-height: 19pt;text-align: left;">실행계획 그림을 인덱스와 테이블로 나눠서 그리시오</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">SELECT /*+ index_desc(emp emp_job) */ename,sal,job FROM EMP</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 12pt;text-align: left;">WHERE job=&#39;SALESMAN&#39;;</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">(<span class="p">주의사항</span>! Index range scan <span class="p">그림이어야함</span>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="619" height="265" alt="image" src="Oracle3_tuning/Image_011.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-top: 10pt;padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark5">Index skip scan</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="553" height="51" alt="image" src="Oracle3_tuning/Image_012.png"/></span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">결합 인덱스에 두번째 칼럼에 인덱스를 쓰는방법이다. 첫번째 칼럼의 distinct 개수가 적을때 성능을 향상시킬수 있는 방법이다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 195%;text-align: left;">Index skip scan <span class="p">을 이해하려면 결합 컬럼 인덱스에 대해서 이해가 먼저 되어야 한다. Pb 14. Demobld.sql 수행후 결합컬럼 인덱스 생성</span></p><p class="s9" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">Pb 15. <span class="p">방금만든 emp_deptno_sal의 인덱스의 구조가 어떻게 되었는지 확인하시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT deptno,sal,rowid FROM EMP</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE deptno&gt;0;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 16. <span class="p">부서번호가 20번인 사원들의 이름과 월급과 부서번호를 출력하는데 emp_deptno_Sal 인덱스를 엑세스 할 수 있도록 힌트를 주시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_desc(emp emp_deptno_sal) */ ename,sal,deptno FROM EMP</p><p class="s9" style="padding-top: 5pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE deptno=20;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 17. <span class="p">월급이 </span>3000<span class="p">인 사원의 이름</span>, <span class="p">월급을 출력하는데 실행 계획에</span></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">emp_deptno_sal<span class="p">인덱스를 엑세스 하는지 확인해보시오</span>.</p><p class="s9" style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT ename,sal FROM EMP WHERE sal=3000;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="267" height="41" alt="image" src="Oracle3_tuning/Image_013.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">왜 인덱스 emp_deptno_sal 인덱스를 엑세스 하지 못하고 full table scan 을 하는가?</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">결함컬럼 인덱스의 첫번째 컬럼이 where 절에 검색조건으로 존재해야 그 인덱스를 엑세스 할수 있다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">이런 경우에 emp_deptno_sal 인덱스를 엑세스 하게 하려면 <span style=" color: #F00;">index skip scan</span>을 사용해야 한다.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="265" height="51" alt="image" src="Oracle3_tuning/Image_014.png"/></span></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">두번째 index 칼럼에서 인덱스 사용한다.</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">//두번째 칼럼에만 인덱스 적용</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+index_ss(emp emp_deptno_sal)*/ ename,sal FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE sal=1100;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;">인덱스 스킵 스캔의 효과를 보기위한 조건</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 18. 직업 + 월급으로 결합 컬럼 인덱스를 생성하고 아래의 SQL이 index skip scan 할 수 있도록 힌트를 주시오.</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Select ename, sal, job, hiredate From emp</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Where sal=1250;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="text-indent: 0pt;text-align: left;">CREATE INDEX emp_job_sal ON EMP(job,sal);</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="294" height="54" alt="image" src="Oracle3_tuning/Image_015.png"/></span></p><p class="s9" style="padding-top: 2pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_ss(emp emp_job_sal) */ job,sal FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE sal=1250;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark6">Index skip scan </a><span class="s12">효과를 보기위한 조건</span></p><p style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">결합 컬럼 인덱스의 첫번째 컬럼의 데이터의 종류가 몇가지 안되어야 효과를 볼 수 있다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="543" height="439" alt="image" src="Oracle3_tuning/Image_016.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;text-align: left;">COL1 의 A~C가 더 성능이 좋은 이유는 A~Z면은 들어갔다가 나왔다 하는 숫자 가 많아져서 느려지기 때문이다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">같은 ROW수의 A~Z가 COL1에 있다고 한다면 접근 횟수가 그만큼 늘어나기 때 문에 느려진다.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 21. <span class="p">사원테이블의 사원번호에 인덱스를 생성하고 사원의 인원수가 몇명인지 카운트 하시오</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark7">Index full scan</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="556" height="51" alt="image" src="Oracle3_tuning/Image_017.png"/></span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Index leaf block 전체를 순차적으로 access 하는 operation.</p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">일반적으로 index full scan operation 이 발생을 하게 되면 SQL성능은 떨어지게 된다</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="551" height="184" alt="image" src="Oracle3_tuning/Image_018.png"/></span></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 17pt;text-align: left;">!!Stopkey <span class="p">활용 중요</span></p><p class="s9" style="padding-top: 1pt;padding-left: 15pt;text-indent: 0pt;text-align: left;">SELECT * FROM (</p><p class="s9" style="padding-top: 1pt;padding-left: 15pt;text-indent: 10pt;line-height: 82%;text-align: left;">SELECT /*+ index_desc(emp000 emp000_sal)*/ ename,sal,dense_RANK()OVER (ORDER BY sal desc) AS <span class="p">순위</span></p><p class="s9" style="padding-top: 2pt;padding-left: 20pt;text-indent: 0pt;text-align: left;">FROM EMP000 WHERE sal&gt;0</p><p class="s9" style="padding-left: 20pt;text-indent: 0pt;line-height: 12pt;text-align: left;">)</p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 18pt;text-align: left;">WHERE <span class="p">순위</span>=1;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="566" height="120" alt="image" src="Oracle3_tuning/Image_019.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="214" height="97" alt="image" src="Oracle3_tuning/Image_020.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Stopkey <span class="s10">를 쓰도록 유도하면 인덱스에서 정렬을하고 위에것만 불러와서 대단히 빠를수있다.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 20. <span class="p">사원 테이블의 인원수가 몇명인지 카운트 하시오</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="215" height="54" alt="image" src="Oracle3_tuning/Image_021.png"/></span></p><p class="s9" style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT COUNT(empno) FROM EMP; SELECT COUNT(*) FROM EMP; SELECT COUNT(1) FROM EMP;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="text-indent: 0pt;text-align: left;">// three have equal performance (just automatically replaced with the first one)</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 5pt;padding-left: 42pt;text-indent: -27pt;text-align: left;">Pb 21. <span class="p">인덱스 걸고 스캔하시오</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">ALTER table EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">ADD CONSTRAINT emp_empno_pk PRIMARY KEY(empno);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT COUNT(*) FROM EMP;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="427" height="78" alt="image" src="Oracle3_tuning/Image_022.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="text-indent: 0pt;line-height: 17pt;text-align: left;">Index full scan <span class="p">이 table full scan 보다 성능이 좋다</span></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">Pb 22. <span class="p">문제 21번을 다시 수행하는데 테이블 full scan 으로 수행되게 하시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Select <span style=" color: #F00;">/*+ full(emp) */ </span>count(empno) From emp;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="204" height="74" alt="image" src="Oracle3_tuning/Image_023.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 23. <span class="p">다시 index full scan 힌트를 주고 실행한후에 몇개의 블럭을 읽었는지 확인하시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">Select <span style=" color: #F00;">/*+ index full(emp) */ </span>count(empno) From emp;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="208" height="75" alt="image" src="Oracle3_tuning/Image_024.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark8">Index fast full scan</a></p><table style="border-collapse:collapse;margin-left:32.024pt" cellspacing="0"><tr style="height:20pt"><td style="width:267pt" colspan="2" bgcolor="#CCFFFF"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">인덱스 full 스캔보다 더 성능이 좋은 스캔 -&gt; <span class="s15">병렬처리</span></p></td><td style="width:157pt"/></tr><tr style="height:20pt"><td style="width:424pt" colspan="3" bgcolor="#CCFFFF"><p class="s16" style="text-indent: 0pt;line-height: 17pt;text-align: left;">Index fast full scan<span class="s14">은 full table scan 과 마찬가지로 multi block I/O 를 한다. Multi block</span></p></td></tr><tr style="height:20pt"><td style="width:119pt" bgcolor="#CCFFFF"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">I/O 하기 때문에 데이터</p></td><td style="width:171pt;border-right-style:solid;border-right-width:2pt;border-right-color:#CCFFFF" bgcolor="#FF99CC"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">출력 순서를 전혀 보장하지 않는다.</p></td><td style="width:134pt;border-left-style:solid;border-left-width:2pt;border-left-color:#CCFFFF"/></tr><tr style="height:20pt"><td style="width:270pt" colspan="2" bgcolor="#FF99CC"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">Index full scan은 Index 컬럼만 SQL에 포함되어 있을떄</p></td><td style="width:72pt" bgcolor="#CCFFFF"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 17pt;text-align: left;">발생할수있다.</p></td><td style="width:82pt"/></tr><tr style="height:20pt"><td style="width:415pt" colspan="3" bgcolor="#FF99CC"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">--&gt; 데이터 스캔 범위가 넓으면서 인덱스가 포함되있는 컬럼만 엑세스할때 유용하게</p></td><td style="width:9pt"/></tr><tr style="height:19pt"><td style="width:61pt" bgcolor="#FF99CC"><p class="s14" style="text-indent: 0pt;line-height: 17pt;text-align: left;">쓰일수 있다.</p></td><td style="width:363pt" colspan="2"/></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 2pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">Pb 24.</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">Select /*+ index_ffs(emp emp_empno_pk) */ count(empno) From emp;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="204" height="72" alt="image" src="Oracle3_tuning/Image_025.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 25. <span class="p">직업</span>, <span class="p">직업별 인원수를 출력하는데 </span>ffs <span class="p">인덱스를 이용해서 수행</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">CREATE INDEX emp_job_empno ON EMP(job,empno);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_ffs(emp emp_job_empno)*/ job, COUNT(*) FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;line-height: 13pt;text-align: left;">GROUP BY job;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">ALTER TABLE EMP MODIFY job NOT NULL;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 26. <span class="p">부서번호와 부서번호별 인원수를 출력하는데 가장 빠르게 출력될 수 있도록 적절한 인덱스를 생성하고 힌트를 주고 수행</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">CREATE INDEX emp_deptno_empno ON EMP(deptno,empno);</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_ffs(emp emp_deptno_empno) */ deptno,COUNT(empno) FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">Group by deptno;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 27. 26<span class="p">번</span>SQL<span class="p">을 병렬처리 할 수 있도록 힌트를 주고 실행</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">CREATE INDEX emp_deptno_empno ON EMP(deptno,empno); SELECT /*+ index_ffs(emp emp_deptno_empno) parallel_index(emp, emp_deptno_empno,4) */</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">deptno, COUNT(*) FROM EMP</p><p style="text-indent: 0pt;text-align: left;"><span><img width="628" height="187" alt="image" src="Oracle3_tuning/Image_026.jpg"/></span></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">GROUP BY deptno;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 6pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">Show parameter cpu_count</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 5pt;padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 28. <span class="p">이름에 </span>EN<span class="p">또는 </span>IN<span class="p">을 포함하고 있는 사원들의 이름</span>, <span class="p">월급</span>, <span class="p">직업을 출력</span></p><p class="s9" style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT ename,sal,job FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE ename LIKE &#39;%EN%&#39; OR ename LIKE &#39;%IN%&#39; ;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Pb 29. <span class="p">위에꺼 튜닝</span></p><p class="s9" style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_desc(emp emp_ename) */ename,sal,job FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE ename LIKE &#39;%EN%&#39; OR ename LIKE &#39;%IN%&#39; or ename&gt; &#39; &#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_ffs(emp emp_ename) */ rowid FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE ename LIKE &#39;%EN%&#39; OR ename LIKE &#39;%IN%&#39;;</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="536" height="58" alt="image" src="Oracle3_tuning/Image_027.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">위에서 구한 <span class="s9">rowid 3</span>건을 가지고 해당 <span class="s9">rowid</span>의 테이블의 이름<span class="s9">, </span>월급<span class="s9">, </span>직업을 출력</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;line-height: 13pt;text-align: left;">SELECT ename,sal,job FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE ROWID IN (</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_ffs(emp emp_ename) */ rowid FROM EMP</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">WHERE ename LIKE &#39;%EN%&#39; OR ename LIKE &#39;%IN%&#39;);</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="593" height="64" alt="image" src="Oracle3_tuning/Image_028.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="198" height="75" alt="image" src="Oracle3_tuning/Image_029.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 69pt;text-indent: -27pt;text-align: left;">SELECT /*+ leading (e3 e1) use_nl(e1) rowid(e1)*/ e1.ename, e1.sal, e1.job</p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">FROM EMP e1,</p><p class="s9" style="padding-left: 52pt;text-indent: 16pt;text-align: left;">(SELECT /*+ index_ffs(e2 emp_ename) no_merge*/ ROWID rr FROM EMP e2</p><p class="s9" style="padding-left: 51pt;text-indent: 0pt;text-align: left;">WHERE ename LIKE &#39;%EN%&#39; OR ename LIKE &#39;%IN%&#39;)e3 WHERE E1.ROWID = e3.rr;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 5pt;padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 30. <span class="p">이름에 </span>EN<span class="p">또는 </span>IN<span class="p">을 포함하고 있는 사원들의 이름</span>, <span class="p">월급</span>, <span class="p">직업을 출력하는데 정규식을 사용해서 출력하면 성능이 더 좋아지는지 확인 해보시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT ename,sal,job FROM EMP</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE regexp_like(ename,&#39;(EN|IN)&#39;);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark9">Index merge scan</a></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Where <span class="p">에 조건이 여러개가 있고 그 조건에 사용되는 컬럼이 다 단일컬럼 인덱스로 구성되어 있을때 하나의 인덱스를 사용하는게 아니라 여러개의 인덱스를 동시에</span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">사용해서 시너지 효과를 보는 스캔방법.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 31. demobld.sql을 돌리고 직업이 salesman 이고 부서번호가 30번인 사원들의 이름과 월급과 직업, 부서번호를 출력하시오</p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT ename,sal,job,deptno FROM EMP</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">WHERE job=&#39;SALESMAN&#39; AND DEPTNO=30;</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="212" height="73" alt="image" src="Oracle3_tuning/Image_030.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 32. <span class="p">직업과 부서번호에 각각 단일 컬럼 인덱스를 생성하고 문제 31번 쿼리의 실행계획을 보면 직업과 부서번호 2개중에 어느 컬럼에 인덱스를 엑세스 하겠는가?</span></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Mostaly job</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 33. <span class="p">그렇다면 왜 deptno에 인덱스를 타지 않고 job의 인덱스를 탔을까?</span></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Job 이 6개라서 deptno 4 라서? I don&#39;t agree a bit.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: -27pt;text-align: left;">Pb 34. 그러면 emp_dept 인덱스를 엑세스 하겠금 힌트를 주고 실행 <span class="s9">SELECT /*+ index(emp000 emp_deptno)*/ename,sal,job,deptno FROM EMP</span></p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE job=&#39;SALESMAN&#39; AND DEPTNO=30;</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="213" height="76" alt="image" src="Oracle3_tuning/Image_031.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Pb 35. <span class="p">아래의 SQL이 index merge scan 이 될수 있도록 힌트를 주시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">Select /*+ and_equal (emp emp_job emp_deptno) */ ename, sal, job, deptno from emp</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">Where job=&#39;SALESMAN&#39; and deptno=30;</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="615" height="141" alt="image" src="Oracle3_tuning/Image_032.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="206" height="106" alt="image" src="Oracle3_tuning/Image_033.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark10">Index bitmap merge( combination)</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="534" height="102" alt="image" src="Oracle3_tuning/Image_034.png"/></span></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Index merge scan <span class="p">의 진화된 기술로 여러개의 인덱스를 각각 bitmap으로 변환해서 하나로 합쳐서 구한 rowid로 테이블을 엑세스 하는 스캔방법.</span></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Insert <span class="p">절의 컬럼이 모두 인덱스에 등록되어 있지 않아도 됨</span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">너무 많은 인덱스를 조합하면 오히려 성능이 떨어질수 있으니 주의</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="163" height="18" alt="image" src="Oracle3_tuning/Image_035.png"/></span></p><p class="s9" style="padding-top: 2pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_combin(emp) */ ename,sal,job,deptno</p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 13pt;text-align: left;">FROM EMP</p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE job=&#39;SALESMAN&#39; AND deptno=30;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="text-indent: 0pt;line-height: 17pt;text-align: left;">//<span class="p">위와 같이 지정하게 되면 테이블내의 모든 인덱스를 조합한다</span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: justify;">Pb 36. <span class="p">우리반 테이블에 전공과 통신사에 각각 단일 컬럼 인덱스를 걸고 전공이 경제학이고 통신사가 SK인 학생들의 이름과 전공과 통신사를 출력하는 쿼리의 실행계획이 index bitmap merge scan이 되도록 하시오</span></p><p class="s9" style="padding-top: 2pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT /*+ index_combin(emp2) */ename,major,telecom FROM EMP2</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 17pt;text-align: left;">WHERE major=&#39;<span class="p">경제학</span>&#39; AND telecom=&#39;sk&#39;</p><p class="s4" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark11">Index join</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="516" height="102" alt="image" src="Oracle3_tuning/Image_036.png"/></span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">테이블을 엑세스 하지 않으면서 인덱스만 가지고 조인을 해서 결과를 보여주는 스캔방법</p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">Where <span class="p">절과 insert 절에 컬럼이 모두 인덱스에 등록되어 있어야함</span></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">---&gt; <span class="p">조회하는 범위가 많지 않으면서 인덱스 안에있는것만 조합하여 조회할때</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: -27pt;text-align: left;">Select empno, ename From emp</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">Where empno=7788;</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="573" height="99" alt="image" src="Oracle3_tuning/Image_037.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 37. <span class="p">아래의 SQL을 index join 엑세스 방법으로 힌트를 줘서 테이블 엑세스를 하지 말게 하시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">Select /*+ index_join(emp)*/ empno, ename From emp</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Where empno=7788;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 17pt;text-align: left;">안됨</p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 10pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: -27pt;line-height: 17pt;text-align: left;">Pb 38. empno<span class="p">와 ename에 각각 not null 제약을 걸고 실행계획을 확인하시오</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="575" height="152" alt="image" src="Oracle3_tuning/Image_038.png"/></span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">Select /*+ index_join(emp emp_empno emp_ename)*/ empno, ename From emp</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">Where empno=7788 AND empno IS NOT NULL AND ename IS NOT NULL;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><a name="bookmark12">Sum up</a></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">Pb 39. <span class="p">전공이 통계학이고 나이가 20대인 학생의 학생번호, 이름과 전공과 나이를 출력하는 쿼리를 작성하는데 쿼리의 성능이 높아지도록 적절하게 인덱스를 생성하고</span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">인덱스를 잘 탈 수 있도록 힌트를 사용해서 SQL을 작성하시오</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 17pt;text-align: left;">여러칼럼 인덱스 걸어도됨</p><p class="s9" style="padding-top: 2pt;padding-left: 59pt;text-indent: 27pt;text-align: left;">Create index emp2_indx2 on emp2(major,age,empno, ename);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;text-align: left;">Consisent block 줄이는 방법 (별 도움안됨)</p><p class="s9" style="padding-top: 2pt;padding-left: 86pt;text-indent: 0pt;line-height: 13pt;text-align: left;">SELECT e.empno,e.EMAIL FROM EMP2 e</p><p class="s9" style="padding-left: 113pt;text-indent: -27pt;line-height: 17pt;text-align: left;">WHERE e.major=&#39;<span class="p">통계학</span>&#39;</p><p class="s9" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">AND e.age LIKE &#39;2%&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">Pb 40. <span class="p">아래의 sql을 튜닝하시오</span></p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">CREATE INDEX emp2_ename ON emp2(ename);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT ename,age,major FROM EMP2</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 17pt;text-align: left;">WHERE SUBSTR(ename,1,1)=&#39;<span class="p">김</span>&#39;;</p><p class="s9" style="padding-top: 1pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">---------------------------------------------------------</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT ename,age,major FROM EMP2</p><p class="s9" style="padding-left: 32pt;text-indent: 26pt;line-height: 17pt;text-align: left;">WHERE ename LIKE &#39;<span class="p">김</span>%&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 59pt;text-indent: -27pt;text-align: left;">Pb 41. <span class="p">아래의 SQL을 튜닝 </span>SELECT ename,age,major FROM EMP2</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: left;">WHERE TO_CHAR(birth,&#39;RR/MM/DD&#39;) =&#39;92/05/25&#39;;</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">----------------------------------------------------------------------------</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">SELECT ename,age,major FROM EMP2</p><p class="s9" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">WHERE birth =TO_DATE(&#39;1992/05/25&#39;,&#39;RRRR/MM/DD&#39;);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark13">Index combine </a><span class="s6">과 </span>index join<span class="s6">의 차이점</span></p><p class="s9" style="padding-top: 1pt;padding-left: 32pt;text-indent: 0pt;line-height: 19pt;text-align: left;">INDEX COMBINE<span class="p">은 SELECT 절의 컬럼과 WHERE 절의 컬럼이 모두 INDEX 에 존재하지 않아도됨</span></p><p class="s9" style="padding-left: 32pt;text-indent: 0pt;line-height: 18pt;text-align: left;">INDEX_JOIN<span class="p">의 경우가 속도면에서 조금더 유리함</span></p></body></html>
